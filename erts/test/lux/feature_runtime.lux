[doc Test genreal working of runtime state of features]

[include features.luxinc]

[invoke setup]

[newshell erl]
    !erl
    ?$ERLPROMPT

    [invoke same-members "features:enabled_features()" "[cond_expr,maps]"]

    !features:keywords().
    ??[]
    ?$ERLPROMPT

    [invoke same-members "features:enable_feature(maybe_expr)" "[cond_expr,maps,maybe_expr]"]

    !features:keywords().
    ??['maybe','else']
    ?$ERLPROMPT

    [invoke same-members "features:disable_feature(maybe_expr)" "[cond_expr,maps]"]

    !features:keywords().
    ??[]
    ?$ERLPROMPT

    [invoke same-members "features:enable_feature(ifn_expr)" "[cond_expr,maps,ifn_expr]"]

    [invoke same-members "features:enable_feature(maybe_expr)" "[cond_expr,maps,ifn_expr,maybe_expr]"]

    [invoke same-members "features:enabled_features()" "[cond_expr,maps,ifn_expr,maybe_expr]"]

    !features:keywords().
    ??['maybe','else','ifn']

    [invoke same-members "features:disable_feature(ifn_expr)" "[cond_expr,maps,maybe_expr]"]

    [invoke same-members "features:enabled_features()" "[cond_expr,maps,maybe_expr]"]

    !features:keywords().
    ??['maybe','else']
    ?$ERLPROMPT

    [invoke same-members "features:disable_feature(maybe_expr)" "[cond_expr,maps]"]

    !features:keywords().
    ??[]
    ?$ERLPROMPT

    !features:enable_feature(misfeature).
    ??invalid_feature
    ??argument 1: unknown feature
    ?$ERLPROMPT

[cleanup]